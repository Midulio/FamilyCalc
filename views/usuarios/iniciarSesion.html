<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400..800&family=Fredoka:wght@300..700&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link href="iniciarSesion.css" rel="stylesheet"/>
    <title>Inicio de Sesión - FamilyCalc</title>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>

    <nav class="navbar">
            <div class="container-fluid d-flex align-items-center justify-content-between">
                <button class="btn btn-primary menu" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions"><img src="../../src/list.svg"></button>
                <div class="offcanvas offcanvas-start interiorMenu" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions" aria-labelledby="offcanvasWithBothOptionsLabel">
                <div class="offcanvas-header">
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body interiorMenu">
                    <div class="explorar"> <h4>EXPLORAR</h4>
                        <a href="../../index.html"><img src="../../src/house.svg">Inicio</a>
                        <a href="../movimientos/index_movimientos.php"><img src="../../src/bank.svg">Gastos</a>
                        <a href="../casas/index_casa.php"><img src="../../src/users.svg">Personas</a>
                        <a href="#"><img src="../../src/chart-line.svg">Estadísticas de gastos</a>
                        <a href="../Impuestos_valores/imp_val.html"><img src="../../src/percent.svg">Valores de las monedas</a>
                    </div>
                    <div class="container-fluid d-flex justify-content-between contactos-box position-absolute bottom-0 start-50 translate-middle-x">
                        <a class="contactos" href="#"><img class="position-absolute top-50 start-50 translate-middle" src="../../src/facebook-logo.svg"></a>
                        <a class="contactos" href="#"><img class="position-absolute top-50 start-50 translate-middle" src="../../src/instagram-logo.svg"></a>
                        <a class="contactos" href="#"><img class="position-absolute top-50 start-50 translate-middle" src="../../src/envelope.svg"></a>
                        <a class="contactos" href="#"><img class="position-absolute top-50 start-50 translate-middle" src="../../src/phone.svg"></a>
                    </div>
                </div>
                </div>
                <a href="../../index.html" class="logo"><h1 class="mb-1 fs-2"><span class="family">Family</span><span class="calc">Calc</span></h1></a>
                <div>
                </div>
            </div>
        </nav>
        <div class="container d-flex justify-content-center align-items-center">
    <div class="card shadow-sm mx-auto formulario">
      <div class="card-header text-center bg-primary text-white">
        <h2 class="my-auto">INICIAR SESIÓN</h2>
      </div>
      <div class="card-body">
        <form id="formLogin">
          <div class="mb-5">
            <label class="form-label">Nombre de usuario o email</label>
            <input type="text" name="usuario" class="form-control" required>
          </div>
          <div class="mb-5">
            <label class="form-label">Contraseña</label>
            <input type="password" name="contraseña" class="form-control" required>
          </div>
          <input type="submit" value="Iniciar sesión" class="btn btn-success w-100">
          <div class="text-center mt-4">
            ¿No tienes cuenta? <a href="registrarse.html">Registrarse</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="toastMensaje" class="toast align-items-center text-white border-0" role="alert">
      <div class="d-flex">
        <div class="toast-body"></div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
      </div>
    </div>
  </div>
        <script>
    const form = document.getElementById('formLogin');
    const toastEl = document.getElementById('toastMensaje');
    const toastBody = toastEl.querySelector('.toast-body');
    const toast = new bootstrap.Toast(toastEl);

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);

      try {
        const res = await fetch('procesar_login.php', {
          method: 'POST',
          body: formData
        });

        const data = await res.json();

        toastEl.classList.remove('bg-success', 'bg-danger');

        if (data.success) {
          toastEl.classList.add('bg-success');
          toastBody.textContent = data.message + " Redirigiendo...";
          toast.show();
          setTimeout(() => window.location.href = "../../index.html", 2000);
        } else {
          toastEl.classList.add('bg-danger');
          toastBody.textContent = data.message || "Error desconocido.";
          toast.show();
        }

      } catch (error) {
        toastEl.classList.remove('bg-success');
        toastEl.classList.add('bg-danger');
        toastBody.textContent = "Error de conexión con el servidor.";
        toast.show();
      }
    });
  </script>
</body>
</html>